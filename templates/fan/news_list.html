{% extends 'fan/_fan_base.html' %}

{% block title %}News - {{ prefs.league_name }}{% endblock %}

{% block fan_content %}
<div class="container">
    <h1 class="page-title">Latest News</h1>

    {% if news_posts %}
        {% set num_news_to_show = prefs.fan_mode_home_number_news %}
        {% set latest_news = news_posts[:num_news_to_show] %}

        <div class="news-list">
            {% for post in latest_news %}
            <div class="news-item">
                <h2 class="news-subject"><a href="{{ url_for('fan.view_news', news_id=post.News_ID) }}">{{ post.Subject }}</a></h2>
                <p class="news-date">{{ post.Date }}</p>
                {% if prefs.fan_mode_home_show_news == 'Show Excerpts' %}
                    <div class="news-excerpt">
                        {{ post.Content | striptags | truncate(200, True, '...') }}
                    </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        {% if news_posts|length > num_news_to_show %}
            <p class="text-center"><a href="{{ url_for('fan.news_list') }}">View All News</a></p>
        {% endif %}

        <h2 class="section-title">News Archives</h2>
        <div class="archive-links">
            {% for year in years %}
                <a href="{{ url_for('fan.news_archive_by_year', year=year) }}" class="archive-link">{{ year }}</a>{% if not loop.last %}, {% endif %}
            {% endfor %}
        </div>
    {% else %}
        <p>No news posts available.</p>
    {% endif %}
</div>
{% endblock %}
